# 성능 기준선 (Baseline)

## 개요

이 문서는 AI 면접 코치 시스템의 성능 기준선을 정의합니다.
기준선은 성능 회귀 감지 및 최적화 효과 측정의 기준점으로 사용됩니다.

## 측정 환경

### 하드웨어

| 항목 | 사양 |
|------|------|
| CPU | Apple M2 / Intel Core i7-12700 (개발 환경) |
| Memory | 16GB RAM |
| Storage | NVMe SSD |

### 소프트웨어

| 항목 | 버전 |
|------|------|
| Java | 21 (Temurin) |
| Spring Boot | 3.2.0 |
| PostgreSQL | 16 |
| Redis | 7 |
| ChromaDB | latest |

### 테스트 조건

- 모든 서비스가 로컬 환경에서 실행
- Docker 컨테이너로 DB/캐시 실행
- LLM API는 실제 호출 (Claude API)

## 서비스별 기준선

### Gateway (포트 8080)

| 메트릭 | 기준값 | 설명 |
|--------|--------|------|
| P95 응답 시간 | < 100ms | 라우팅만 수행 |
| P99 응답 시간 | < 200ms | |
| 처리량 | > 1000 RPS | |
| 에러율 | < 0.1% | |

### User Service (포트 8081)

#### 로그인 API

| 메트릭 | 기준값 | 설명 |
|--------|--------|------|
| P95 응답 시간 | < 200ms | JWT 발급 포함 |
| P99 응답 시간 | < 500ms | |
| 처리량 | > 500 RPS | |
| 에러율 | < 0.1% | |

#### 회원가입 API

| 메트릭 | 기준값 | 설명 |
|--------|--------|------|
| P95 응답 시간 | < 500ms | 비밀번호 해싱 포함 |
| P99 응답 시간 | < 1000ms | |
| 처리량 | > 100 RPS | |
| 에러율 | < 1% | 중복 이메일 제외 |

#### 프로필 조회 API

| 메트릭 | 기준값 | 설명 |
|--------|--------|------|
| P95 응답 시간 | < 100ms | |
| P99 응답 시간 | < 200ms | |
| 처리량 | > 1000 RPS | |
| 에러율 | < 0.1% | |

### Question Service (포트 8082)

#### JD 분석 API (LLM)

| 메트릭 | 기준값 | 설명 |
|--------|--------|------|
| P95 응답 시간 | < 30s | Claude API 호출 |
| P99 응답 시간 | < 60s | |
| 처리량 | > 2 RPS | API 제한 고려 |
| 에러율 | < 10% | 타임아웃 포함 |

#### RAG 검색 API

| 메트릭 | 기준값 | 설명 |
|--------|--------|------|
| P95 응답 시간 | < 2s | ChromaDB 검색 |
| P99 응답 시간 | < 5s | |
| 처리량 | > 50 RPS | |
| 에러율 | < 2% | |

#### 질문 목록 API

| 메트릭 | 기준값 | 설명 |
|--------|--------|------|
| P95 응답 시간 | < 200ms | 페이지네이션 |
| P99 응답 시간 | < 500ms | |
| 처리량 | > 500 RPS | |
| 에러율 | < 0.1% | |

### Interview Service (포트 8083)

#### 세션 생성 API

| 메트릭 | 기준값 | 설명 |
|--------|--------|------|
| P95 응답 시간 | < 300ms | |
| P99 응답 시간 | < 500ms | |
| 처리량 | > 200 RPS | |
| 에러율 | < 0.5% | |

#### 답변 제출 API

| 메트릭 | 기준값 | 설명 |
|--------|--------|------|
| P95 응답 시간 | < 500ms | |
| P99 응답 시간 | < 1000ms | |
| 처리량 | > 100 RPS | |
| 에러율 | < 1% | |

### Feedback Service (포트 8084)

#### SSE 스트리밍 피드백

| 메트릭 | 기준값 | 설명 |
|--------|--------|------|
| 연결 시간 | < 1s | 초기 연결 |
| 첫 이벤트 시간 | < 5s | LLM 응답 시작 |
| 총 스트림 시간 | < 60s | 전체 피드백 |
| 에러율 | < 5% | 연결 끊김 포함 |

#### 통계 API

| 메트릭 | 기준값 | 설명 |
|--------|--------|------|
| P95 응답 시간 | < 1s | 집계 쿼리 |
| P99 응답 시간 | < 2s | |
| 처리량 | > 100 RPS | |
| 에러율 | < 1% | |

## 시나리오별 기준선

### Smoke Test

| 메트릭 | 기준값 |
|--------|--------|
| 총 요청 수 | > 100 |
| 에러율 | < 1% |
| 체크 성공률 | > 99% |

### Load Test (100 VU)

| 메트릭 | 기준값 |
|--------|--------|
| 총 요청 수 | > 10,000 |
| P95 응답 시간 | < 500ms |
| 에러율 | < 1% |
| 처리량 | > 100 RPS |

### Stress Test (500 VU)

| 메트릭 | 기준값 |
|--------|--------|
| 총 요청 수 | > 30,000 |
| P95 응답 시간 | < 2s |
| 에러율 | < 10% |
| 회복 시간 | < 30s |

### Spike Test

| 메트릭 | 기준값 |
|--------|--------|
| 스파이크 중 에러율 | < 15% |
| 회복 후 에러율 | < 1% |
| 회복 시간 | < 30s |

## 측정 방법

### 기준선 측정 실행

```bash
# 1. 모니터링 스택 실행
cd performance/monitoring
docker-compose -f docker-compose.monitoring.yml up -d

# 2. 모든 서비스 실행
cd backend && ./gradlew bootRun

# 3. 기준선 측정 (3회 평균)
for i in {1..3}; do
  ./performance/scripts/run-load.sh -t load -o results/baseline-$i
done

# 4. 결과 분석
./performance/scripts/generate-report.sh
```

### 기준선 업데이트

기준선은 다음 상황에서 업데이트해야 합니다:

1. **인프라 변경**: 서버 스펙 변경, DB 마이그레이션
2. **주요 기능 추가**: 새로운 서비스, 대규모 리팩토링
3. **분기별 검토**: 최소 분기 1회

### 업데이트 절차

1. 현재 기준선과 새 측정값 비교
2. 변경 사유 문서화
3. 새 기준선 커밋 (`git commit -m "perf: update baseline"`)
4. 팀 리뷰

## 버전 이력

| 버전 | 날짜 | 변경 사항 |
|------|------|-----------|
| 1.0 | 2024-01-XX | 초기 기준선 설정 |

---

*마지막 업데이트: YYYY-MM-DD*
